-- Arceus X Command Panel UI
-- Transformed to match tcmd UI style

local lib = {}

local Script_Title = "ARCEUS X | COMMAND PANEL"
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

-- Instances:
local Arceus = Instance.new("ScreenGui")
local Main = Instance.new("Frame")
local MainCorner = Instance.new("UICorner")
local MainStroke = Instance.new("UIStroke")
local PulseOutline = Instance.new("UIStroke")

local Header = Instance.new("Frame")
local HeaderBackground = Instance.new("Frame")
local HeaderCorner = Instance.new("UICorner")
local Title = Instance.new("TextLabel")
local CloseButton = Instance.new("TextButton")
local CloseCorner = Instance.new("UICorner")

local Logo = Instance.new("ImageButton")
local LogoAspect = Instance.new("UIAspectRatioConstraint")

local Menu = Instance.new("ScrollingFrame")
local UIListLayout = Instance.new("UIListLayout")
local UIPadding = Instance.new("UIPadding")

-- Element templates
local Toggle = Instance.new("Frame")
local ToggleCorner = Instance.new("UICorner")
local ToggleStroke = Instance.new("UIStroke")
local ToggleLabel = Instance.new("TextLabel")
local ToggleSwitch = Instance.new("Frame")
local SwitchCorner = Instance.new("UICorner")
local SwitchDot = Instance.new("Frame")
local DotCorner = Instance.new("UICorner")

local Button = Instance.new("Frame")
local ButtonCorner = Instance.new("UICorner")
local ButtonStroke = Instance.new("UIStroke")
local ButtonLabel = Instance.new("TextLabel")

local InputBox = Instance.new("Frame")
local InputCorner = Instance.new("UICorner")
local InputStroke = Instance.new("UIStroke")
local InputLabel = Instance.new("TextLabel")
local InputTextBox = Instance.new("TextBox")
local TextBoxCorner = Instance.new("UICorner")

local Dropdown = Instance.new("Frame")
local DropdownCorner = Instance.new("UICorner")
local DropdownStroke = Instance.new("UIStroke")
local DropdownLabel = Instance.new("TextLabel")
local DropdownArrow = Instance.new("TextLabel")

local DropdownItem = Instance.new("Frame")
local ItemCorner = Instance.new("UICorner")
local ItemStroke = Instance.new("UIStroke")
local ItemLabel = Instance.new("TextLabel")

local Space = Instance.new("Frame")

-- Properties:
Arceus.Name = "ArceusCmdPanel"
Arceus.Enabled = true
Arceus.ResetOnSpawn = false
Arceus.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
Arceus.DisplayOrder = 999

-- Main Container (tcmd style)
Main.Name = "Main"
Main.Parent = Arceus
Main.Active = true
Main.Draggable = false
Main.AnchorPoint = Vector2.new(0.5, 0.5)
Main.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
Main.BackgroundTransparency = 0.1
Main.BorderSizePixel = 0
Main.Position = UDim2.new(0.5, 0, 0.5, 0)
Main.Size = UDim2.new(0.32, 0, 0.42, 0)

MainCorner.CornerRadius = UDim.new(0, 8)
MainCorner.Parent = Main

-- Border effects
MainStroke.Color = Color3.fromRGB(80, 80, 90)
MainStroke.Thickness = 1
MainStroke.Transparency = 0.5
MainStroke.Parent = Main

PulseOutline.Color = Color3.fromRGB(255, 50, 50)
PulseOutline.Thickness = 2
PulseOutline.Transparency = 1
PulseOutline.Parent = Main

-- Header (for dragging)
Header.Name = "Header"
Header.Size = UDim2.new(1, 0, 0.1, 0)
Header.Position = UDim2.new(0, 0, 0, 0)
Header.BackgroundTransparency = 1
Header.ZIndex = 10
Header.Parent = Main

-- Header background
HeaderBackground.Size = UDim2.new(1, 0, 1, 0)
HeaderBackground.Position = UDim2.new(0, 0, 0, 0)
HeaderBackground.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
HeaderBackground.BackgroundTransparency = 0.2
HeaderBackground.BorderSizePixel = 0
HeaderBackground.ZIndex = 1
HeaderBackground.Parent = Header

HeaderCorner.CornerRadius = UDim.new(0, 8)
HeaderCorner.Parent = HeaderBackground

-- Title
Title.Name = "Title"
Title.Size = UDim2.new(0.7, 0, 0.8, 0)
Title.Position = UDim2.new(0.05, 0, 0.1, 0)
Title.BackgroundTransparency = 1
Title.Text = Script_Title
Title.TextColor3 = Color3.fromRGB(220, 220, 220)
Title.TextScaled = true
Title.Font = Enum.Font.GothamSemibold
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.ZIndex = 2
Title.Parent = Header

-- Close Button (minimizes to logo)
CloseButton.Name = "Close"
CloseButton.Size = UDim2.new(0.1, 0, 0.7, 0)
CloseButton.Position = UDim2.new(0.88, 0, 0.15, 0)
CloseButton.BackgroundColor3 = Color3.fromRGB(60, 60, 65)
CloseButton.BackgroundTransparency = 0.7
CloseButton.Text = "×"
CloseButton.TextColor3 = Color3.fromRGB(255, 50, 50)
CloseButton.TextSize = 24
CloseButton.Font = Enum.Font.GothamBold
CloseButton.ZIndex = 2
CloseButton.Parent = Header

CloseCorner.CornerRadius = UDim.new(0.5, 0)
CloseCorner.Parent = CloseButton

-- Logo (minimized state)
Logo.Name = "Logo"
Logo.Parent = Main
Logo.AnchorPoint = Vector2.new(1, 0)
Logo.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Logo.BackgroundTransparency = 1
Logo.BorderSizePixel = 0
Logo.Position = UDim2.new(0.95, 0, 0.05, 0)
Logo.Size = UDim2.new(0.08, 0, 0.08, 0)
Logo.Image = "http://www.roblox.com/asset/?id=9178187770"
Logo.ScaleType = Enum.ScaleType.Fit
Logo.Visible = false
Logo.ZIndex = 15

LogoAspect.Parent = Logo

-- Menu (ScrollingFrame)
Menu.Name = "Menu"
Menu.Parent = Main
Menu.Active = true
Menu.AnchorPoint = Vector2.new(0.5, 0)
Menu.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Menu.BackgroundTransparency = 1
Menu.BorderSizePixel = 0
Menu.Position = UDim2.new(0.5, 0, 0.12, 0)
Menu.Size = UDim2.new(0.95, 0, 0.86, 0)
Menu.CanvasSize = UDim2.new(0, 0, 0, 0)
Menu.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 110)
Menu.ScrollBarThickness = 4
Menu.AutomaticCanvasSize = Enum.AutomaticSize.Y

UIPadding.PaddingLeft = UDim.new(0, 2)
UIPadding.PaddingRight = UDim.new(0, 2)
UIPadding.PaddingTop = UDim.new(0, 5)
UIPadding.PaddingBottom = UDim.new(0, 5)
UIPadding.Parent = Menu

UIListLayout.Padding = UDim.new(0, 8)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Parent = Menu

-- Toggle Template (tcmd style)
Toggle.Name = "Toggle"
Toggle.Visible = false
Toggle.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
Toggle.BackgroundTransparency = 0.9
Toggle.Size = UDim2.new(1, 0, 0, 32)

ToggleCorner.CornerRadius = UDim.new(0, 6)
ToggleCorner.Parent = Toggle

ToggleStroke.Color = Color3.fromRGB(60, 60, 70)
ToggleStroke.Thickness = 1
ToggleStroke.Transparency = 0.5
ToggleStroke.Parent = Toggle

ToggleLabel.Name = "Name"
ToggleLabel.Parent = Toggle
ToggleLabel.AnchorPoint = Vector2.new(0, 0.5)
ToggleLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
ToggleLabel.BackgroundTransparency = 1
ToggleLabel.BorderSizePixel = 0
ToggleLabel.Position = UDim2.new(0.05, 0, 0.5, 0)
ToggleLabel.Size = UDim2.new(0.7, 0, 0.8, 0)
ToggleLabel.Font = Enum.Font.Gotham
ToggleLabel.Text = "Toggle"
ToggleLabel.TextColor3 = Color3.fromRGB(200, 200, 210)
ToggleLabel.TextSize = 14
ToggleLabel.TextWrapped = true
ToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
ToggleLabel.TextYAlignment = Enum.TextYAlignment.Center

-- Modern toggle switch
ToggleSwitch.Name = "Switch"
ToggleSwitch.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
ToggleSwitch.Size = UDim2.new(0.15, 0, 0.6, 0)
ToggleSwitch.AnchorPoint = Vector2.new(1, 0.5)
ToggleSwitch.Position = UDim2.new(0.95, 0, 0.5, 0)
ToggleSwitch.Parent = Toggle

SwitchCorner.CornerRadius = UDim.new(0.5, 0)
SwitchCorner.Parent = ToggleSwitch

SwitchDot.Name = "Dot"
SwitchDot.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
SwitchDot.Size = UDim2.new(0.4, 0, 0.8, 0)
SwitchDot.AnchorPoint = Vector2.new(0.5, 0.5)
SwitchDot.Position = UDim2.new(0.3, 0, 0.5, 0)
SwitchDot.Parent = ToggleSwitch

DotCorner.CornerRadius = UDim.new(0.5, 0)
DotCorner.Parent = SwitchDot

-- Button Template
Button.Name = "Button"
Button.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
Button.BackgroundTransparency = 0.9
Button.Size = UDim2.new(1, 0, 0, 32)

ButtonCorner.CornerRadius = UDim.new(0, 6)
ButtonCorner.Parent = Button

ButtonStroke.Color = Color3.fromRGB(60, 60, 70)
ButtonStroke.Thickness = 1
ButtonStroke.Transparency = 0.5
ButtonStroke.Parent = Button

ButtonLabel.Name = "Name"
ButtonLabel.Parent = Button
ButtonLabel.AnchorPoint = Vector2.new(0, 0.5)
ButtonLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
ButtonLabel.BackgroundTransparency = 1
ButtonLabel.BorderSizePixel = 0
ButtonLabel.Position = UDim2.new(0.05, 0, 0.5, 0)
ButtonLabel.Size = UDim2.new(0.9, 0, 0.8, 0)
ButtonLabel.Font = Enum.Font.Gotham
ButtonLabel.Text = "Button"
ButtonLabel.TextColor3 = Color3.fromRGB(200, 200, 210)
ButtonLabel.TextSize = 14
ButtonLabel.TextWrapped = true
ButtonLabel.TextXAlignment = Enum.TextXAlignment.Left
ButtonLabel.TextYAlignment = Enum.TextYAlignment.Center

-- InputBox Template
InputBox.Name = "InputBox"
InputBox.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
InputBox.BackgroundTransparency = 0.9
InputBox.Size = UDim2.new(1, 0, 0, 32)

InputCorner.CornerRadius = UDim.new(0, 6)
InputCorner.Parent = InputBox

InputStroke.Color = Color3.fromRGB(60, 60, 70)
InputStroke.Thickness = 1
InputStroke.Transparency = 0.5
InputStroke.Parent = InputBox

InputLabel.Name = "Name"
InputLabel.Parent = InputBox
InputLabel.AnchorPoint = Vector2.new(0, 0.5)
InputLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
InputLabel.BackgroundTransparency = 1
InputLabel.BorderSizePixel = 0
InputLabel.Position = UDim2.new(0.05, 0, 0.5, 0)
InputLabel.Size = UDim2.new(0.5, 0, 0.8, 0)
InputLabel.Font = Enum.Font.Gotham
InputLabel.Text = "Input"
InputLabel.TextColor3 = Color3.fromRGB(200, 200, 210)
InputLabel.TextSize = 14
InputLabel.TextWrapped = true
InputLabel.TextXAlignment = Enum.TextXAlignment.Left
InputLabel.TextYAlignment = Enum.TextYAlignment.Center

InputTextBox.Name = "TextBox"
InputTextBox.Parent = InputBox
InputTextBox.AnchorPoint = Vector2.new(1, 0.5)
InputTextBox.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
InputTextBox.BackgroundTransparency = 0.5
InputTextBox.BorderSizePixel = 0
InputTextBox.Position = UDim2.new(0.95, 0, 0.5, 0)
InputTextBox.Size = UDim2.new(0.4, 0, 0.7, 0)
InputTextBox.Font = Enum.Font.Gotham
InputTextBox.PlaceholderColor3 = Color3.fromRGB(120, 120, 130)
InputTextBox.PlaceholderText = "Enter..."
InputTextBox.Text = ""
InputTextBox.TextColor3 = Color3.fromRGB(200, 200, 210)
InputTextBox.TextSize = 14
InputTextBox.TextWrapped = true
InputTextBox.ClearTextOnFocus = false

TextBoxCorner.CornerRadius = UDim.new(0, 4)
TextBoxCorner.Parent = InputTextBox

-- Dropdown Template
Dropdown.Name = "Dropdown"
Dropdown.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
Dropdown.BackgroundTransparency = 0.9
Dropdown.Size = UDim2.new(1, 0, 0, 32)

DropdownCorner.CornerRadius = UDim.new(0, 6)
DropdownCorner.Parent = Dropdown

DropdownStroke.Color = Color3.fromRGB(60, 60, 70)
DropdownStroke.Thickness = 1
DropdownStroke.Transparency = 0.5
DropdownStroke.Parent = Dropdown

DropdownLabel.Name = "Name"
DropdownLabel.Parent = Dropdown
DropdownLabel.AnchorPoint = Vector2.new(0, 0.5)
DropdownLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
DropdownLabel.BackgroundTransparency = 1
DropdownLabel.BorderSizePixel = 0
DropdownLabel.Position = UDim2.new(0.05, 0, 0.5, 0)
DropdownLabel.Size = UDim2.new(0.7, 0, 0.8, 0)
DropdownLabel.Font = Enum.Font.Gotham
DropdownLabel.Text = "Dropdown"
DropdownLabel.TextColor3 = Color3.fromRGB(200, 200, 210)
DropdownLabel.TextSize = 14
DropdownLabel.TextWrapped = true
DropdownLabel.TextXAlignment = Enum.TextXAlignment.Left
DropdownLabel.TextYAlignment = Enum.TextYAlignment.Center

DropdownArrow.Name = "Arrow"
DropdownArrow.Parent = Dropdown
DropdownArrow.AnchorPoint = Vector2.new(1, 0.5)
DropdownArrow.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
DropdownArrow.BackgroundTransparency = 1
DropdownArrow.BorderSizePixel = 0
DropdownArrow.Position = UDim2.new(0.95, 0, 0.5, 0)
DropdownArrow.Size = UDim2.new(0.1, 0, 0.8, 0)
DropdownArrow.Font = Enum.Font.GothamBold
DropdownArrow.Text = "▼"
DropdownArrow.TextColor3 = Color3.fromRGB(255, 50, 50)
DropdownArrow.TextSize = 14
DropdownArrow.TextYAlignment = Enum.TextYAlignment.Center

-- Dropdown Item Template
DropdownItem.Name = "DropdownItem"
DropdownItem.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
DropdownItem.BackgroundTransparency = 0.8
DropdownItem.Size = UDim2.new(1, 0, 0, 28)

ItemCorner.CornerRadius = UDim.new(0, 4)
ItemCorner.Parent = DropdownItem

ItemStroke.Color = Color3.fromRGB(50, 50, 60)
ItemStroke.Thickness = 1
ItemStroke.Transparency = 0.5
ItemStroke.Parent = DropdownItem

ItemLabel.Name = "Name"
ItemLabel.Parent = DropdownItem
ItemLabel.AnchorPoint = Vector2.new(0, 0.5)
ItemLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
ItemLabel.BackgroundTransparency = 1
ItemLabel.BorderSizePixel = 0
ItemLabel.Position = UDim2.new(0.05, 0, 0.5, 0)
ItemLabel.Size = UDim2.new(0.9, 0, 0.8, 0)
ItemLabel.Font = Enum.Font.Gotham
ItemLabel.Text = "Item"
ItemLabel.TextColor3 = Color3.fromRGB(200, 200, 210)
ItemLabel.TextSize = 13
ItemLabel.TextWrapped = true
ItemLabel.TextXAlignment = Enum.TextXAlignment.Left
ItemLabel.TextYAlignment = Enum.TextYAlignment.Center

-- Space Template
Space.Name = "Space"
Space.Visible = false
Space.BackgroundTransparency = 1
Space.Size = UDim2.new(1, 0, 0, 10)

-- SCRIPT

local dragging = false
local dragInput, dragStart, startPos

-- Dragging function from tcmd UI
local function updateInput(input)
    local delta = input.Position - dragStart
    local newPos = UDim2.new(
        startPos.X.Scale, 
        startPos.X.Offset + delta.X,
        startPos.Y.Scale, 
        startPos.Y.Offset + delta.Y
    )
    
    local viewportSize = workspace.CurrentCamera.ViewportSize
    local frameSize = Main.AbsoluteSize
    
    newPos = UDim2.new(
        math.clamp(newPos.X.Scale, 0, 1),
        math.clamp(newPos.X.Offset, 0, viewportSize.X - frameSize.X),
        math.clamp(newPos.Y.Scale, 0, 1),
        math.clamp(newPos.Y.Offset, 0, viewportSize.Y - frameSize.Y)
    )
    
    Main.Position = newPos
end

Header.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = Main.Position
        
        -- Pulse effect when starting drag
        PulseOutline.Transparency = 0
        TweenService:Create(PulseOutline, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            Transparency = 1
        }):Play()

        local connection
        connection = input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
                connection:Disconnect()
            end
        end)
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        updateInput(input)
    end
end)

-- Hover effects for interactive elements
local function applyHoverEffects(element)
    element.MouseEnter:Connect(function()
        TweenService:Create(element, TweenInfo.new(0.2), {
            BackgroundTransparency = 0.85,
            BackgroundColor3 = Color3.fromRGB(45, 45, 50)
        }):Play()
        TweenService:Create(element:FindFirstChildWhichIsA("UIStroke"), TweenInfo.new(0.2), {
            Transparency = 0.3
        }):Play()
    end)
    
    element.MouseLeave:Connect(function()
        TweenService:Create(element, TweenInfo.new(0.2), {
            BackgroundTransparency = 0.9,
            BackgroundColor3 = Color3.fromRGB(35, 35, 40)
        }):Play()
        TweenService:Create(element:FindFirstChildWhichIsA("UIStroke"), TweenInfo.new(0.2), {
            Transparency = 0.5
        }):Play()
    end)
end

-- Close/Minimize functionality
CloseButton.MouseButton1Click:Connect(function()
    Logo.Visible = true
    Menu.Visible = false
    Header.Visible = false
    
    TweenService:Create(Main, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
        Size = UDim2.new(0, 60, 0, 60),
        BackgroundTransparency = 0.3
    }):Play()
end)

Logo.MouseButton1Click:Connect(function()
    Logo.Visible = false
    Menu.Visible = true
    Header.Visible = true
    
    TweenService:Create(Main, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
        Size = UDim2.new(0.32, 0, 0.42, 0),
        BackgroundTransparency = 0.1
    }):Play()
end)

-- Parent UI
local function uiparent()
    local success, parent = pcall(function()
        return gethui()
    end)

    if not success then
        return game:GetService("CoreGui")
    end

    return parent
end

Arceus.Parent = uiparent()

local elements = 0

local function AddSpace(parent)
    local space = Space:Clone()
    space.Parent = parent
    space.LayoutOrder = elements
    space.Visible = true
    elements += 1
end

-- Enhanced toggle animation
local function animateToggle(switch, state)
    local dot = switch.Dot
    local targetPosition = state and 0.7 or 0.3
    local targetColor = state and Color3.fromRGB(0, 255, 100) or Color3.fromRGB(255, 50, 50)
    
    TweenService:Create(dot, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
        Position = UDim2.new(targetPosition, 0, 0.5, 0),
        BackgroundColor3 = targetColor
    }):Play()
end

function lib:AddToggle(name, funct, enabled, ...)
    local newTog = Toggle:Clone()
    local args = {...}
    
    newTog.Name = name
    newTog.LayoutOrder = elements
    newTog.Visible = true
    newTog.Parent = Menu
    
    newTog.Label.Text = name
    newTog.Switch.Dot.Position = enabled and UDim2.new(0.7, 0, 0.5, 0) or UDim2.new(0.3, 0, 0.5, 0)
    newTog.Switch.Dot.BackgroundColor3 = enabled and Color3.fromRGB(0, 255, 100) or Color3.fromRGB(255, 50, 50)
    
    newTog.MouseButton1Click:Connect(function()
        enabled = not enabled
        animateToggle(newTog.Switch, enabled)
        funct(enabled, unpack(args))
    end)
    
    applyHoverEffects(newTog)
    elements += 1
    
    return newTog
end

function lib:AddButton(name, funct, ...)
    local newBut = Button:Clone()
    local args = {...}
    
    newBut.Name = name
    newBut.LayoutOrder = elements
    newBut.Visible = true
    newBut.Parent = Menu
    
    newBut.Label.Text = name
    
    newBut.MouseButton1Click:Connect(function()
        -- Click animation
        TweenService:Create(newBut, TweenInfo.new(0.1), {
            BackgroundTransparency = 0.8,
            BackgroundColor3 = Color3.fromRGB(60, 60, 70)
        }):Play()
        
        task.wait(0.1)
        
        TweenService:Create(newBut, TweenInfo.new(0.1), {
            BackgroundTransparency = 0.9,
            BackgroundColor3 = Color3.fromRGB(35, 35, 40)
        }):Play()
        
        funct(unpack(args))
    end)
    
    applyHoverEffects(newBut)
    elements += 1
    
    return newBut
end

function lib:AddInputBox(name, funct, placeholder, default, ...)
    local newInput = InputBox:Clone()
    local args = {...}
    
    newInput.Name = name
    newInput.LayoutOrder = elements
    newInput.Visible = true
    newInput.Parent = Menu
    
    newInput.NameLabel.Text = name
    newInput.TextBox.PlaceholderText = placeholder or "Enter text..."
    newInput.TextBox.Text = default or ""
    
    local textBox = newInput.TextBox
    
    -- Focus effects
    textBox.Focused:Connect(function()
        TweenService:Create(newInput:FindFirstChildWhichIsA("UIStroke"), TweenInfo.new(0.2), {
            Color = Color3.fromRGB(255, 50, 50),
            Transparency = 0.3
        }):Play()
    end)
    
    textBox.FocusLost:Connect(function(enterPressed)
        TweenService:Create(newInput:FindFirstChildWhichIsA("UIStroke"), TweenInfo.new(0.2), {
            Color = Color3.fromRGB(60, 60, 70),
            Transparency = 0.5
        }):Play()
        
        if enterPressed then
            funct(textBox.Text, unpack(args))
        end
    end)
    
    applyHoverEffects(newInput)
    elements += 1
    
    local inputObj = {
        Frame = newInput,
        TextBox = textBox,
        GetText = function() return textBox.Text end,
        SetText = function(newText) textBox.Text = newText or "" end,
        Clear = function() textBox.Text = "" end,
        SetPlaceholder = function(text) textBox.PlaceholderText = text or "" end
    }
    
    return inputObj
end

function lib:AddComboBox(name, options, funct, ...)
    local newDropdown = Dropdown:Clone()
    local args = {...}
    local isOpen = false
    local items = {}
    
    newDropdown.Name = name
    newDropdown.LayoutOrder = elements
    newDropdown.Visible = true
    newDropdown.Parent = Menu
    
    newDropdown.Label.Text = name .. ": " .. (options[1] or "")
    
    local function toggleDropdown()
        isOpen = not isOpen
        
        -- Rotate arrow
        TweenService:Create(newDropdown.Arrow, TweenInfo.new(0.2), {
            Rotation = isOpen and 180 or 0
        }):Play()
        
        -- Show/hide items
        for _, item in ipairs(items) do
            item.Visible = isOpen
        end
    end
    
    newDropdown.MouseButton1Click:Connect(toggleDropdown)
    
    applyHoverEffects(newDropdown)
    elements += 1
    
    -- Create dropdown items
    for i, option in ipairs(options) do
        local newItem = DropdownItem:Clone()
        newItem.Name = option
        newItem.LayoutOrder = elements + i
        newItem.Visible = false
        newItem.Parent = Menu
        
        newItem.Label.Text = option
        
        newItem.MouseButton1Click:Connect(function()
            newDropdown.Label.Text = name .. ": " .. option
            toggleDropdown()
            funct(option, unpack(args))
        end)
        
        applyHoverEffects(newItem)
        table.insert(items, newItem)
    end
    
    elements += #options
    
    return newDropdown
end

function lib:AddSection(name)
    local section = Space:Clone()
    section.Name = name
    section.Size = UDim2.new(1, 0, 0, 25)
    section.BackgroundTransparency = 0.9
    section.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    section.LayoutOrder = elements
    section.Visible = true
    section.Parent = Menu
    
    local sectionCorner = Instance.new("UICorner")
    sectionCorner.CornerRadius = UDim.new(0, 4)
    sectionCorner.Parent = section
    
    local sectionLabel = Instance.new("TextLabel")
    sectionLabel.Size = UDim2.new(1, -10, 1, 0)
    sectionLabel.Position = UDim2.new(0.05, 0, 0, 0)
    sectionLabel.BackgroundTransparency = 1
    sectionLabel.Text = "─── " .. name .. " ───"
    sectionLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
    sectionLabel.TextSize = 14
    sectionLabel.Font = Enum.Font.GothamBold
    sectionLabel.TextXAlignment = Enum.TextXAlignment.Center
    sectionLabel.TextYAlignment = Enum.TextYAlignment.Center
    sectionLabel.Parent = section
    
    elements += 1
    
    return section
end

function lib:SetTitle(txt)
    Title.Text = txt
end

function lib:SetIcon(img)
    Logo.Image = img
end

function lib:SetBackgroundColor(r, g, b)
    Main.BackgroundColor3 = Color3.fromRGB(r, g, b)
    HeaderBackground.BackgroundColor3 = Color3.fromRGB(
        math.min(255, r + 10),
        math.min(255, g + 10),
        math.min(255, b + 10)
    )
end

function lib:SetTitleColor(r, g, b)
    Title.TextColor3 = Color3.fromRGB(r, g, b)
end

function lib:SetAccentColor(r, g, b)
    local accent = Color3.fromRGB(r, g, b)
    CloseButton.TextColor3 = accent
    DropdownArrow.TextColor3 = accent
    SwitchDot.BackgroundColor3 = accent
    PulseOutline.Color = accent
end

function lib:SetTheme(theme)
    if theme == "Default" then
        lib:SetBackgroundColor(40, 40, 45)
        lib:SetAccentColor(255, 50, 50)
        lib:SetTitleColor(220, 220, 220)
        
    elseif theme == "TomorrowNightBlue" then
        lib:SetBackgroundColor(5, 16, 58)
        lib:SetAccentColor(74, 208, 238)
        lib:SetTitleColor(200, 220, 255)
        
    elseif theme == "Dark" then
        lib:SetBackgroundColor(20, 20, 25)
        lib:SetAccentColor(200, 200, 200)
        lib:SetTitleColor(220, 220, 220)
        
    elseif theme == "Red" then
        lib:SetBackgroundColor(30, 20, 20)
        lib:SetAccentColor(255, 80, 80)
        lib:SetTitleColor(255, 200, 200)
        
    elseif theme == "Green" then
        lib:SetBackgroundColor(20, 30, 20)
        lib:SetAccentColor(80, 255, 80)
        lib:SetTitleColor(200, 255, 200)
        
    else
        warn("Theme not found, using Default")
    end
end

-- Enhanced initialization animation
Main.Position = UDim2.new(0.5, 0, 0.3, 0)
Main.Size = UDim2.new(0, 0, 0.42, 0)
Main.BackgroundTransparency = 1

TweenService:Create(Main, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
    Size = UDim2.new(0.32, 0, 0.42, 0),
    BackgroundTransparency = 0.1
}):Play()

TweenService:Create(Main, TweenInfo.new(0.4, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
    Position = UDim2.new(0.5, 0, 0.5, 0)
}):Play()

-- Set default theme
lib:SetTheme("Default")

return lib
