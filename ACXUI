local lib = {}

local Script_Title = "Arceus X <font color=\"rgb(255, 0, 0)\">|</font> Ui Lib"

-- Animation presets
local FadeIn = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
local FadeOut = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.In)
local SlideIn = TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out, 0.2)
local SlideOut = TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.In, 0.2)
local ScaleUp = TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
local ScaleDown = TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.In)

-- Instances with enhanced properties
local Arceus = Instance.new("ScreenGui")
local Main = Instance.new("Frame")
local UICorner = Instance.new("UICorner")
local UIGradient_Main = Instance.new("UIGradient")
local UIStroke = Instance.new("UIStroke")
local DropShadow = Instance.new("ImageLabel")

local Intro = Instance.new("Frame")
local UICorner_2 = Instance.new("UICorner")
local Logo = Instance.new("ImageButton")
local UIAspectRatioConstraint = Instance.new("UIAspectRatioConstraint")
local Title = Instance.new("TextLabel")
local Menu = Instance.new("ScrollingFrame")
local UIListLayout = Instance.new("UIListLayout")
local Close = Instance.new("TextButton")

-- Element templates
local Toggle = Instance.new("ImageButton")
local Button = Instance.new("ImageButton")
local ComboBox = Instance.new("ImageButton")
local ComboElem = Instance.new("ImageButton")
local InputBox = Instance.new("ImageButton")
local tab = Instance.new("Frame")

-- Properties with enhanced visuals

Arceus.Name = "Arceus"
Arceus.Enabled = true
Arceus.ResetOnSpawn = true
Arceus.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
Arceus.DisplayOrder = 999999999

-- Main Frame with transparency and gradient
Main.Name = "Main"
Main.Parent = Arceus
Main.Active = true
Main.Draggable = true
Main.AnchorPoint = Vector2.new(0.5, 0.5)
Main.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
Main.BackgroundTransparency = 0.1
Main.BorderSizePixel = 0
Main.Position = UDim2.new(0.5, 0, -0.2, 0)
Main.Size = UDim2.new(0.3, 0, 0.3, 0)
Main.ZIndex = 1

-- Gradient background
UIGradient_Main.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 30, 40)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(20, 20, 30))
}
UIGradient_Main.Rotation = 45
UIGradient_Main.Parent = Main

-- Rounded corners
UICorner.CornerRadius = UDim.new(0.08, 0)
UICorner.Parent = Main

-- Subtle stroke
UIStroke.Color = Color3.fromRGB(60, 60, 80)
UIStroke.Thickness = 2
UIStroke.Transparency = 0.3
UIStroke.Parent = Main

-- Drop shadow effect
DropShadow.Name = "DropShadow"
DropShadow.Parent = Main
DropShadow.AnchorPoint = Vector2.new(0.5, 0.5)
DropShadow.BackgroundTransparency = 1
DropShadow.BorderSizePixel = 0
DropShadow.Position = UDim2.new(0.5, 4, 0.5, 4)
DropShadow.Size = UDim2.new(1, 8, 1, 8)
DropShadow.ZIndex = 0
DropShadow.Image = "rbxassetid://1316045217"
DropShadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
DropShadow.ImageTransparency = 0.7
DropShadow.ScaleType = Enum.ScaleType.Slice
DropShadow.SliceCenter = Rect.new(10, 10, 118, 118)

-- Intro screen with blur effect
Intro.Name = "Intro"
Intro.Parent = Main
Intro.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
Intro.BackgroundTransparency = 0.05
Intro.ClipsDescendants = true
Intro.Size = UDim2.new(1, 0, 1, 0)
Intro.ZIndex = 2

UICorner_2.CornerRadius = UDim.new(0.08, 0)
UICorner_2.Parent = Intro

Logo.Parent = Intro
Logo.AnchorPoint = Vector2.new(0.5, 0.5)
Logo.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Logo.BackgroundTransparency = 1
Logo.BorderSizePixel = 0
Logo.Position = UDim2.new(0.5, 0, 0.5, 0)
Logo.Size = UDim2.new(0.75, 0, 0.75, 0)
Logo.ZIndex = 3
Logo.Image = "http://www.roblox.com/asset/?id=9178187770"
Logo.ImageTransparency = 0
Logo.ScaleType = Enum.ScaleType.Fit
Logo.Active = false

UIAspectRatioConstraint.Parent = Logo

-- Title with glow effect
Title.Name = "Title"
Title.Parent = Main
Title.AnchorPoint = Vector2.new(1, 0)
Title.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Title.BackgroundTransparency = 1
Title.BorderSizePixel = 0
Title.Position = UDim2.new(0.975, 0, 0.075, 0)
Title.Size = UDim2.new(0.85, 0, 0.155, 0)
Title.Font = Enum.Font.TitilliumWeb
Title.FontFace = Font.new("rbxasset://fonts/families/TitilliumWeb.json", Enum.FontWeight.Bold)
Title.RichText = true
Title.Text = Script_Title
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextScaled = true
Title.TextSize = 14
Title.TextWrapped = true
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.TextYAlignment = Enum.TextYAlignment.Center
Title.ZIndex = 2

-- Add text shadow
local TitleShadow = Title:Clone()
TitleShadow.Name = "TitleShadow"
TitleShadow.Parent = Main
TitleShadow.Position = Title.Position + UDim2.new(0, 2, 0, 2)
TitleShadow.TextColor3 = Color3.fromRGB(0, 0, 0)
TitleShadow.TextTransparency = 0.7
TitleShadow.ZIndex = 1

-- Enhanced Menu
Menu.Name = "Menu"
Menu.Parent = Main
Menu.Active = true
Menu.AnchorPoint = Vector2.new(0.5, 1)
Menu.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Menu.BackgroundTransparency = 1
Menu.AutomaticCanvasSize = Enum.AutomaticSize.Y
Menu.BorderSizePixel = 0
Menu.Position = UDim2.new(0.5, 0, 0.95, 0)
Menu.Size = UDim2.new(0.95, 0, 0.65, 0)
Menu.CanvasSize = UDim2.new(0, 0, 0, 0)
Menu.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 120)
Menu.ScrollBarThickness = Menu.AbsoluteSize.X/25
Menu.ZIndex = 2

UIListLayout.Parent = Menu
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Padding = UDim.new(0.015, 0)

-- Enhanced Close Button
Close.Name = "Close"
Close.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Close.BackgroundTransparency = 1
Close.BorderSizePixel = 0
Close.Position = UDim2.new(0.8, 0, 0.1, 0)
Close.Size = UDim2.new(0.15, 0, 0.125, 0)
Close.Font = Enum.Font.FredokaOne
Close.Text = "✕"
Close.TextColor3 = Color3.fromRGB(255, 80, 80)
Close.TextScaled = true
Close.TextSize = 14
Close.TextWrapped = true
Close.TextXAlignment = Enum.TextXAlignment.Right
Close.ZIndex = 2
Close.Parent = Main

-- Enhanced Toggle Button
Toggle.Name = "Toggle"
Toggle.Visible = false
Toggle.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
Toggle.BackgroundTransparency = 0.1
Toggle.Size = UDim2.new(0.95, 0, 0, 50)

local ToggleCorner = Instance.new("UICorner")
ToggleCorner.CornerRadius = UDim.new(0.2, 0)
ToggleCorner.Parent = Toggle

local ToggleStroke = Instance.new("UIStroke")
ToggleStroke.Color = Color3.fromRGB(60, 60, 80)
ToggleStroke.Thickness = 1
ToggleStroke.Transparency = 0.5
ToggleStroke.Parent = Toggle

local Enabled = Instance.new("Frame")
Enabled.Name = "Enabled"
Enabled.Parent = Toggle
Enabled.AnchorPoint = Vector2.new(1, 0.5)
Enabled.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
Enabled.Position = UDim2.new(0.975, 0, 0.5, 0)
Enabled.Size = UDim2.new(0.75, 0, 0.75, 0)

local UIAspectRatioConstraint_2 = Instance.new("UIAspectRatioConstraint")
UIAspectRatioConstraint_2.Parent = Enabled

local UICorner_4 = Instance.new("UICorner")
UICorner_4.CornerRadius = UDim.new(0.3, 0)
UICorner_4.Parent = Enabled

local Check = Instance.new("Frame")
Check.Name = "Check"
Check.Parent = Enabled
Check.AnchorPoint = Vector2.new(0.5, 0.5)
Check.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
Check.Position = UDim2.new(0.5, 0, 0.5, 0)
Check.Size = UDim2.new(0.65, 0, 0.65, 0)

local UIAspectRatioConstraint_3 = Instance.new("UIAspectRatioConstraint")
UIAspectRatioConstraint_3.Parent = Check

local UICorner_5 = Instance.new("UICorner")
UICorner_5.CornerRadius = UDim.new(0.3, 0)
UICorner_5.Parent = Check

local Name = Instance.new("TextLabel")
Name.Name = "Name"
Name.Parent = Toggle
Name.AnchorPoint = Vector2.new(0, 0.5)
Name.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Name.BackgroundTransparency = 1
Name.BorderSizePixel = 0
Name.Position = UDim2.new(0.05, 0, 0.5, 0)
Name.Size = UDim2.new(0.75, 0, 0.8, 0)
Name.Font = Enum.Font.TitilliumWeb
Name.Text = "Toggle"
Name.TextColor3 = Color3.fromRGB(255, 255, 255)
Name.TextScaled = true
Name.TextSize = 14
Name.TextWrapped = true
Name.TextXAlignment = Enum.TextXAlignment.Left
Name.TextYAlignment = Enum.TextYAlignment.Bottom

-- Enhanced Button
Button.Name = "Button"
Button.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
Button.BackgroundTransparency = 0.1
Button.Size = UDim2.new(0.95, 0, 0, 50)

local ButtonCorner = Instance.new("UICorner")
ButtonCorner.CornerRadius = UDim.new(0.2, 0)
ButtonCorner.Parent = Button

local ButtonStroke = Instance.new("UIStroke")
ButtonStroke.Color = Color3.fromRGB(60, 60, 80)
ButtonStroke.Thickness = 1
ButtonStroke.Transparency = 0.5
ButtonStroke.Parent = Button

local Name_2 = Instance.new("TextLabel")
Name_2.Name = "Name"
Name_2.Parent = Button
Name_2.AnchorPoint = Vector2.new(0, 0.5)
Name_2.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Name_2.BackgroundTransparency = 1
Name_2.BorderSizePixel = 0
Name_2.Position = UDim2.new(0.05, 0, 0.5, 0)
Name_2.Size = UDim2.new(0.95, 0, 0.82, 0)
Name_2.Font = Enum.Font.TitilliumWeb
Name_2.Text = "Button"
Name_2.TextColor3 = Color3.fromRGB(255, 255, 255)
Name_2.TextScaled = true
Name_2.TextSize = 14
Name_2.TextWrapped = true
Name_2.TextXAlignment = Enum.TextXAlignment.Left
Name_2.TextYAlignment = Enum.TextYAlignment.Bottom

-- Enhanced Input Box
InputBox.Name = "InputBox"
InputBox.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
InputBox.BackgroundTransparency = 0.1
InputBox.Size = UDim2.new(0.95, 0, 0, 50)
InputBox.AutoButtonColor = false

local InputCorner = Instance.new("UICorner")
InputCorner.CornerRadius = UDim.new(0.2, 0)
InputCorner.Parent = InputBox

local InputStroke = Instance.new("UIStroke")
InputStroke.Color = Color3.fromRGB(60, 60, 80)
InputStroke.Thickness = 1
InputStroke.Transparency = 0.5
InputStroke.Parent = InputBox

local Name_5 = Instance.new("TextLabel")
Name_5.Name = "Name"
Name_5.Parent = InputBox
Name_5.AnchorPoint = Vector2.new(0, 0.5)
Name_5.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Name_5.BackgroundTransparency = 1
Name_5.BorderSizePixel = 0
Name_5.Position = UDim2.new(0.05, 0, 0.5, 0)
Name_5.Size = UDim2.new(0.75, 0, 0.8, 0)
Name_5.Font = Enum.Font.TitilliumWeb
Name_5.Text = "Input Box"
Name_5.TextColor3 = Color3.fromRGB(255, 255, 255)
Name_5.TextScaled = true
Name_5.TextSize = 14
Name_5.TextWrapped = true
Name_5.TextXAlignment = Enum.TextXAlignment.Left
Name_5.TextYAlignment = Enum.TextYAlignment.Bottom

local TextBox = Instance.new("TextBox")
TextBox.Name = "TextBox"
TextBox.Parent = InputBox
TextBox.AnchorPoint = Vector2.new(1, 0.5)
TextBox.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
TextBox.BackgroundTransparency = 0.1
TextBox.BorderSizePixel = 0
TextBox.Position = UDim2.new(0.95, 0, 0.5, 0)
TextBox.Size = UDim2.new(0.35, 0, 0.6, 0)
TextBox.Font = Enum.Font.TitilliumWeb
TextBox.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
TextBox.PlaceholderText = "Enter text..."
TextBox.Text = ""
TextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
TextBox.TextScaled = true
TextBox.TextSize = 14
TextBox.TextWrapped = true

local TextBoxCorner = Instance.new("UICorner")
TextBoxCorner.CornerRadius = UDim.new(0.15, 0)
TextBoxCorner.Parent = TextBox

-- Enhanced ComboBox
ComboBox.Name = "ComboBox"
ComboBox.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
ComboBox.BackgroundTransparency = 0.1
ComboBox.Size = UDim2.new(0.95, 0, 0, 50)

local ComboCorner = Instance.new("UICorner")
ComboCorner.CornerRadius = UDim.new(0.2, 0)
ComboCorner.Parent = ComboBox

local ComboStroke = Instance.new("UIStroke")
ComboStroke.Color = Color3.fromRGB(60, 60, 80)
ComboStroke.Thickness = 1
ComboStroke.Transparency = 0.5
ComboStroke.Parent = ComboBox

local Name_4 = Instance.new("TextLabel")
Name_4.Name = "Name"
Name_4.Parent = ComboBox
Name_4.AnchorPoint = Vector2.new(0, 0.5)
Name_4.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Name_4.BackgroundTransparency = 1
Name_4.BorderSizePixel = 0
Name_4.Position = UDim2.new(0.05, 0, 0.5, 0)
Name_4.Size = UDim2.new(0.75, 0, 0.8, 0)
Name_4.Font = Enum.Font.TitilliumWeb
Name_4.Text = "ComboBox"
Name_4.TextColor3 = Color3.fromRGB(255, 255, 255)
Name_4.TextScaled = true
Name_4.TextSize = 14
Name_4.TextWrapped = true
Name_4.TextXAlignment = Enum.TextXAlignment.Left
Name_4.TextYAlignment = Enum.TextYAlignment.Bottom

local Img_2 = Instance.new("TextLabel")
Img_2.Name = "Img"
Img_2.Parent = ComboBox
Img_2.AnchorPoint = Vector2.new(1, 0.5)
Img_2.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Img_2.BackgroundTransparency = 1
Img_2.BorderSizePixel = 0
Img_2.Rotation = 180
Img_2.Position = UDim2.new(0.975, 0, 0.5, 0)
Img_2.Size = UDim2.new(0.75, 0, 0.75, 0)
Img_2.Font = Enum.Font.FredokaOne
Img_2.Text = "▾"
Img_2.TextColor3 = Color3.fromRGB(255, 80, 80)
Img_2.TextScaled = true
Img_2.TextSize = 14
Img_2.TextWrapped = true

local UIAspectRatioConstraint_5 = Instance.new("UIAspectRatioConstraint")
UIAspectRatioConstraint_5.Parent = Img_2

-- Enhanced Combo Element
ComboElem.Name = "ComboElem"
ComboElem.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
ComboElem.BackgroundTransparency = 0.1
ComboElem.Size = UDim2.new(0.95, 0, 0, 50)

local ElemCorner = Instance.new("UICorner")
ElemCorner.CornerRadius = UDim.new(0.15, 0)
ElemCorner.Parent = ComboElem

local ElemStroke = Instance.new("UIStroke")
ElemStroke.Color = Color3.fromRGB(50, 50, 70)
ElemStroke.Thickness = 1
ElemStroke.Transparency = 0.5
ElemStroke.Parent = ComboElem

local Name_3 = Instance.new("TextLabel")
Name_3.Name = "Name"
Name_3.Parent = ComboElem
Name_3.AnchorPoint = Vector2.new(0, 0.5)
Name_3.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Name_3.BackgroundTransparency = 1
Name_3.BorderSizePixel = 0
Name_3.Position = UDim2.new(0.05, 0, 0.5, 0)
Name_3.Size = UDim2.new(0.75, 0, 0.8, 0)
Name_3.Font = Enum.Font.TitilliumWeb
Name_3.Text = "Option"
Name_3.TextColor3 = Color3.fromRGB(255, 255, 255)
Name_3.TextScaled = true
Name_3.TextSize = 14
Name_3.TextWrapped = true
Name_3.TextXAlignment = Enum.TextXAlignment.Left
Name_3.TextYAlignment = Enum.TextYAlignment.Bottom

-- Tab (spacer)
tab.Name = "Tab"
tab.Visible = false
tab.BackgroundTransparency = 1
tab.Size = UDim2.new(0.95, 0, 0.015, 0)

-- Animation Functions
local TweenService = game:GetService("TweenService")

local function fadeIn(object, transparency)
    local tween = TweenService:Create(object, FadeIn, {BackgroundTransparency = transparency or 0.1})
    tween:Play()
    return tween
end

local function fadeOut(object, transparency)
    local tween = TweenService:Create(object, FadeOut, {BackgroundTransparency = transparency or 0.8})
    tween:Play()
    return tween
end

local function slideIn(object, position)
    local tween = TweenService:Create(object, SlideIn, {Position = position})
    tween:Play()
    return tween
end

local function scaleUp(object, size)
    local tween = TweenService:Create(object, ScaleUp, {Size = size})
    tween:Play()
    return tween
end

local function scaleDown(object, size)
    local tween = TweenService:Create(object, ScaleDown, {Size = size})
    tween:Play()
    return tween
end

-- Enhanced Close Button Animation
Close.MouseButton1Click:Connect(function()
    Logo.Active = true
    
    -- Fade in intro with blur effect
    fadeIn(Intro, 0.05)
    
    task.wait(0.2)
    
    -- Logo animation
    scaleUp(Logo, UDim2.fromScale(0.75, 0.75))
    
    task.wait(0.25)
    
    -- Scale down main window
    scaleDown(Main, UDim2.fromScale(0.1, 0.175))
    
    task.wait(0.25)
    
    -- Hide all elements with fade out
    for _, obj in pairs(Main:GetChildren()) do
        if obj:IsA("GuiObject") and obj ~= Intro and obj ~= Logo and obj ~= DropShadow then
            fadeOut(obj, 1):Play()
            task.wait(0.02)
        end
    end
    
    task.wait(0.1)
    
    -- Final fade effects
    fadeOut(Logo, 0.8)
    fadeOut(Intro, 1)
    fadeOut(Main, 0.9)
    fadeOut(DropShadow, 1)
end)

-- Enhanced Logo Click Animation
Logo.MouseButton1Click:Connect(function()
    Logo.Active = false
    
    -- Fade in effects
    fadeIn(Logo, 0)
    fadeIn(Intro, 0.05)
    fadeIn(Main, 0.1)
    fadeIn(DropShadow, 0.7)
    
    task.wait(0.2)
    
    -- Scale up main window
    scaleUp(Main, UDim2.fromScale(0.3, 0.3))
    
    task.wait(0.25)
    
    -- Logo to corner animation
    scaleDown(Logo, UDim2.fromScale(0.175, 0.175))
    
    -- Show all elements with fade in
    for _, obj in pairs(Main:GetChildren()) do
        if obj:IsA("GuiObject") and obj ~= Intro and obj ~= Logo and obj ~= DropShadow then
            obj.Visible = true
            fadeIn(obj)
            task.wait(0.02)
        end
    end
    
    task.wait(0.2)
    
    -- Fade out intro
    fadeOut(Intro, 1)
end)

-- Enhanced Hover Effects
local function setupHoverEffect(button)
    local originalColor = button.BackgroundColor3
    local hoverColor = Color3.fromRGB(
        math.min(255, originalColor.R * 255 + 15),
        math.min(255, originalColor.G * 255 + 15),
        math.min(255, originalColor.B * 255 + 15)
    )
    
    button.MouseEnter:Connect(function()
        TweenService:Create(button, FadeIn, {BackgroundColor3 = hoverColor}):Play()
    end)
    
    button.MouseLeave:Connect(function()
        TweenService:Create(button, FadeIn, {BackgroundColor3 = originalColor}):Play()
    end)
end

-- Setup hover effects for template elements
setupHoverEffect(Toggle)
setupHoverEffect(Button)
setupHoverEffect(ComboBox)
setupHoverEffect(ComboElem)
setupHoverEffect(InputBox)

-- Parent setup function
local function uiparent()
    local success, parent = pcall(function()
        return gethui()
    end)
    
    if not success then
        return game:GetService("CoreGui")
    end
    
    return parent
end

local success, err = pcall(function()
    Arceus.Parent = uiparent()
end)

if not success then
    Arceus.Parent = game:GetService("Players").LocalPlayer.PlayerGui
end

-- Initialize
local element_height = 50 * Menu.AbsoluteSize.Y / 210
local elements = 0

local function AddSpace(parent)
    local space = tab:Clone()
    space.Parent = parent
    space.LayoutOrder = elements
    space.Visible = true
    elements += 1
end

-- Enhanced UI Functions
function lib:AddToggle(name, funct, enabled, ...)
    local newTog = Toggle:Clone()
    local args = {...}
    
    -- Apply hover effect
    setupHoverEffect(newTog)
    
    newTog.MouseButton1Click:Connect(function()
        enabled = not enabled
        
        -- Animate toggle state change
        local check = newTog:WaitForChild("Enabled"):WaitForChild("Check")
        local tween = TweenService:Create(check, ScaleUp, {
            Size = enabled and UDim2.fromScale(0.65, 0.65) or UDim2.fromScale(0, 0)
        })
        tween:Play()
        
        check.Visible = enabled
        funct(enabled, unpack(args))
    end)
    
    newTog:WaitForChild("Enabled"):WaitForChild("Check").Visible = enabled
    newTog:WaitForChild("Name").Text = name
    
    newTog.Size = UDim2.new(0.95, 0, 0, element_height)
    newTog.Name = name
    newTog.Parent = Menu
    newTog.LayoutOrder = elements
    newTog.Visible = true
    
    elements += 1
    AddSpace(Menu)
    
    return newTog
end

function lib:AddButton(name, funct, ...)
    local newBut = Button:Clone()
    local args = {...}
    
    -- Apply hover effect
    setupHoverEffect(newBut)
    
    newBut.MouseButton1Click:Connect(function()
        -- Button press animation
        TweenService:Create(newBut, ScaleDown, {Size = newBut.Size - UDim2.new(0, 2, 0, 2)}):Play()
        task.wait(0.1)
        TweenService:Create(newBut, ScaleUp, {Size = newBut.Size}):Play()
        
        funct(unpack(args))
    end)
    
    newBut:WaitForChild("Name").Text = name
    newBut.Size = UDim2.new(0.95, 0, 0, element_height)
    newBut.Name = name
    newBut.Parent = Menu
    newBut.LayoutOrder = elements
    newBut.Visible = true
    
    elements += 1
    AddSpace(Menu)
    
    return newBut
end

function lib:AddInputBox(name, funct, placeholder, default, ...)
    local newInput = InputBox:Clone()
    local args = {...}
    
    -- Apply hover effect
    setupHoverEffect(newInput)
    
    newInput:WaitForChild("Name").Text = name
    if placeholder then
        newInput.TextBox.PlaceholderText = placeholder
    end
    if default then
        newInput.TextBox.Text = default
    end
    
    local textBox = newInput.TextBox
    
    -- Enhanced text box focus effects
    textBox.Focused:Connect(function()
        TweenService:Create(textBox, FadeIn, {BackgroundColor3 = Color3.fromRGB(45, 45, 60)}):Play()
    end)
    
    textBox.FocusLost:Connect(function(enterPressed)
        TweenService:Create(textBox, FadeIn, {BackgroundColor3 = Color3.fromRGB(35, 35, 45)}):Play()
        if enterPressed then
            funct(textBox.Text, unpack(args))
        end
    end)
    
    newInput.MouseButton1Click:Connect(function()
        if not textBox:IsFocused() then
            textBox:CaptureFocus()
        end
    end)
    
    newInput.Size = UDim2.new(0.95, 0, 0, element_height)
    newInput.Name = name
    newInput.Parent = Menu
    newInput.LayoutOrder = elements
    newInput.Visible = true
    
    elements += 1
    AddSpace(Menu)
    
    -- Return control object
    local inputObj = {
        Frame = newInput,
        TextBox = textBox,
        GetText = function()
            return textBox.Text
        end,
        SetText = function(newText)
            textBox.Text = newText or ""
        end,
        Clear = function()
            textBox.Text = ""
        end,
        SetPlaceholder = function(placeholderText)
            textBox.PlaceholderText = placeholderText or "Enter text..."
        end
    }
    
    return inputObj
end

function lib:AddComboBox(text, options, funct, ...)
    local newCombo = ComboBox:Clone()
    local enabled = false
    local elems = {}
    local args = {...}
    
    -- Apply hover effect
    setupHoverEffect(newCombo)
    
    local function setBoxState()
        local img = newCombo:WaitForChild("Img")
        TweenService:Create(img, FadeIn, {Rotation = enabled and 0 or 180}):Play()
        
        for i, elem in ipairs(elems) do
            if enabled then
                elem.Visible = true
                TweenService:Create(elem, FadeIn, {Position = UDim2.new(0, 0, 0, (i * element_height) + (i * 5))}):Play()
            else
                TweenService:Create(elem, FadeOut, {Position = UDim2.new(0, 0, 0, 0)}):Play()
                task.wait(0.05)
                elem.Visible = false
            end
        end
    end
    
    newCombo.MouseButton1Click:Connect(function()
        enabled = not enabled
        setBoxState()
    end)
    
    newCombo:WaitForChild("Name").Text = text .. ": " .. (#options > 0 and options[1] or "")
    newCombo.Size = UDim2.new(0.95, 0, 0, element_height)
    newCombo.Name = #options > 0 and options[1] or ""
    newCombo.Parent = Menu
    newCombo.LayoutOrder = elements
    newCombo.Visible = true
    
    elements += 1
    AddSpace(Menu)
    
    for _, name in ipairs(options) do
        local newElem = ComboElem:Clone()
        table.insert(elems, newElem)
        
        -- Apply hover effect
        setupHoverEffect(newElem)
        
        newElem.MouseButton1Click:Connect(function()
            newCombo:WaitForChild("Name").Text = text .. ": " .. name
            enabled = false
            setBoxState()
            
            funct(name, unpack(args))
        end)
        
        newElem:WaitForChild("Name").Text = name
        newElem.Size = UDim2.new(0.95, 0, 0, element_height)
        newElem.Name = name
        newElem.Parent = Menu
        newElem.LayoutOrder = elements
        newElem.Visible = false
        
        elements += 1
        AddSpace(Menu)
    end
    
    return newCombo
end

-- Enhanced Theme Functions
function lib:SetTitle(txt)
    Title.Text = txt
    TitleShadow.Text = txt
end

function lib:SetIcon(img)
    Logo.Image = img
end

function lib:SetBackgroundColor(r, g, b)
    Main.BackgroundColor3 = Color3.fromRGB(r, g, b)
    Intro.BackgroundColor3 = Color3.fromRGB(r, g, b)
end

function lib:SetTitleColor(r, g, b)
    Title.TextColor3 = Color3.fromRGB(r, g, b)
end

function lib:SetCloseBtnColor(r, g, b)
    Close.TextColor3 = Color3.fromRGB(r, g, b)
    Img_2.TextColor3 = Color3.fromRGB(r, g, b)
    Check.BackgroundColor3 = Color3.fromRGB(r, g, b)
end

function lib:SetButtonsColor(r, g, b)
    local color = Color3.fromRGB(r, g, b)
    Toggle.BackgroundColor3 = color
    Button.BackgroundColor3 = color
    ComboElem.BackgroundColor3 = color
    ComboBox.BackgroundColor3 = color
    InputBox.BackgroundColor3 = color
end

function lib:SetInputBoxColor(r, g, b)
    InputBox.BackgroundColor3 = Color3.fromRGB(r, g, b)
    TextBox.BackgroundColor3 = Color3.fromRGB(
        math.max(0, r-15), 
        math.max(0, g-15), 
        math.max(0, b-15)
    )
end

function lib:SetTransparency(level)
    Main.BackgroundTransparency = level
    Toggle.BackgroundTransparency = level
    Button.BackgroundTransparency = level
    ComboBox.BackgroundTransparency = level
    InputBox.BackgroundTransparency = level
    DropShadow.ImageTransparency = level + 0.2
end

function lib:EnableShadow(enabled)
    DropShadow.Visible = enabled
end

function lib:SetTheme(theme)
    if theme == "Default" then
        -- Keep current settings
    elseif theme == "Glass" then
        lib:SetTransparency(0.3)
        lib:SetButtonsColor(60, 60, 80)
        lib:SetCloseBtnColor(100, 200, 255)
        lib:SetBackgroundColor(20, 25, 40)
        lib:EnableShadow(true)
    elseif theme == "Dark" then
        lib:SetTransparency(0.1)
        lib:SetButtonsColor(30, 30, 40)
        lib:Set
