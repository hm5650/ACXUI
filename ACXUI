local lib = {}

local Script_Title = "Arceus X <font color=\"rgb(255, 0, 0)\">|</font> Ui Lib"

-- Services
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

-- Instances
local Arceus = Instance.new("ScreenGui")
local Main = Instance.new("Frame")
local UICorner = Instance.new("UICorner")
local Shadow = Instance.new("ImageLabel") -- For soft shadow
local Intro = Instance.new("Frame")
local IntroCorner = Instance.new("UICorner")
local Logo = Instance.new("ImageButton")
local Title = Instance.new("TextLabel")
local Close = Instance.new("TextButton")
local Menu = Instance.new("ScrollingFrame")
local UIListLayout = Instance.new("UIListLayout")

-- Templates (Cloned Later)
local ToggleTemplate = Instance.new("TextButton")
local ButtonTemplate = Instance.new("TextButton")
local ComboBoxTemplate = Instance.new("Frame")
local ComboElemTemplate = Instance.new("TextButton")
local InputBoxTemplate = Instance.new("Frame")

-- Setup ScreenGui
Arceus.Name = "ArceusX_Modern"
Arceus.ResetOnSpawn = false
Arceus.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
Arceus.DisplayOrder = 999999999

-- Main Frame (Semi-transparent + modern)
Main.Name = "Main"
Main.Parent = Arceus
Main.AnchorPoint = Vector2.new(0.5, 0.5)
Main.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
Main.BackgroundTransparency = 0.05
Main.Position = UDim2.new(0.5, 0, -0.3, 0)
Main.Size = UDim2.new(0.35, 0, 0.5, 0)
Main.Active = true
Main.Draggable = true

UICorner.CornerRadius = UDim.new(0, 16)
UICorner.Parent = Main

-- Soft Drop Shadow (Roblox doesn't have real shadows, so we fake it)
Shadow.Name = "Shadow"
Shadow.Parent = Main
Shadow.BackgroundTransparency = 1
Shadow.Position = UDim2.new(0, -15, 0, -15)
Shadow.Size = UDim2.new(1, 30, 1, 30)
Shadow.ZIndex = 0
Shadow.Image = "rbxassetid://6014261993"
Shadow.ImageColor3 = Color3.new(0, 0, 0)
Shadow.ImageTransparency = 0.6
Shadow.ScaleType = Enum.ScaleType.Slice
Shadow.SliceCenter = Rect.new(49, 49, 450, 450)

-- Intro Frame (Logo Splash)
Intro.Name = "Intro"
Intro.Parent = Main
Intro.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
Intro.BackgroundTransparency = 1
Intro.Size = UDim2.new(1, 0, 1, 0)
Intro.ZIndex = 10

IntroCorner.CornerRadius = UDim.new(0, 16)
IntroCorner.Parent = Intro

Logo.Parent = Intro
Logo.BackgroundTransparency = 1
Logo.Position = UDim2.new(0.5, 0, 0.5, 0)
Logo.AnchorPoint = Vector2.new(0.5, 0.5)
Logo.Size = UDim2.new(0.4, 0, 0.4, 0)
Logo.Image = "http://www.roblox.com/asset/?id=9178187770"

-- Title
Title.Name = "Title"
Title.Parent = Main
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 20, 0, 12)
Title.Size = UDim2.new(1, -70, 0, 40)
Title.Font = Enum.Font.GothamBold
Title.Text = Script_Title
Title.RichText = true
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.TextSize = 18

-- Close Button
Close.Parent = Main
Close.BackgroundTransparency = 1
Close.Position = UDim2.new(1, -50, 0, 10)
Close.Size = UDim2.new(0, 40, 0, 40)
Close.Font = Enum.Font.GothamBold
Close.Text = "Ã—"
Close.TextColor3 = Color3.fromRGB(255, 100, 100)
Close.TextSize = 28

-- Menu (Scrolling Area)
Menu.Parent = Main
Menu.BackgroundTransparency = 1
Menu.Position = UDim2.new(0, 15, 0, 70)
Menu.Size = UDim2.new(1, -30, 1, -90)
Menu.CanvasSize = UDim2.new(0, 0, 0, 0)
Menu.AutomaticCanvasSize = Enum.AutomaticSize.Y
Menu.ScrollBarThickness = 4
Menu.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 100)

UIListLayout.Parent = Menu
UIListLayout.Padding = UDim.new(0, 10)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- Toggle Template
ToggleTemplate.Name = "ToggleTemplate"
ToggleTemplate.Size = UDim2.new(1, 0, 0, 50)
ToggleTemplate.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
ToggleTemplate.Text = ""
ToggleTemplate.AutoButtonColor = false

local togCorner = Instance.new("UICorner", ToggleTemplate)
togCorner.CornerRadius = UDim.new(0, 12)

local togName = Instance.new("TextLabel", ToggleTemplate)
togName.BackgroundTransparency = 1
togName.Position = UDim2.new(0, 15, 0, 0)
togName.Size = UDim2.new(1, -80, 1, 0)
togName.Font = Enum.Font.Gotham
togName.TextColor3 = Color3.fromRGB(220, 220, 220)
togName.TextXAlignment = Enum.TextXAlignment.Left
togName.Text = "Toggle Name"
togName.TextSize = 16

local togIndicator = Instance.new("Frame", ToggleTemplate)
togIndicator.Name = "Indicator"
togIndicator.AnchorPoint = Vector2.new(1, 0.5)
togIndicator.Position = UDim2.new(1, -15, 0.5, 0)
togIndicator.Size = UDim2.new(0, 50, 0, 28)
togIndicator.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
togIndicator.BorderSizePixel = 0

local indCorner = Instance.new("UICorner", togIndicator)
indCorner.CornerRadius = UDim.new(1, 0)

local circle = Instance.new("Frame", togIndicator)
circle.Name = "Circle"
circle.Size = UDim2.new(0, 22, 0, 22)
circle.Position = UDim2.new(0, 3, 0.5, 0)
circle.AnchorPoint = Vector2.new(0, 0.5)
circle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)

local circCorner = Instance.new("UICorner", circle)
circCorner.CornerRadius = UDim.new(1, 0)

-- Button Template
ButtonTemplate.Name = "ButtonTemplate"
ButtonTemplate.Size = UDim2.new(1, 0, 0, 50)
ButtonTemplate.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
ButtonTemplate.Text = "Button"
ButtonTemplate.Font = Enum.Font.GothamBold
ButtonTemplate.TextColor3 = Color3.new(1, 1, 1)
ButtonTemplate.TextSize = 16

local btnCorner = Instance.new("UICorner", ButtonTemplate)
btnCorner.CornerRadius = UDim.new(0, 12)

-- Input Box Template
InputBoxTemplate.Name = "InputBoxTemplate"
InputBoxTemplate.Size = UDim2.new(1, 0, 0, 50)
InputBoxTemplate.BackgroundColor3 = Color3.fromRGB(40, 40, 55)

local ibCorner = Instance.new("UICorner", InputBoxTemplate)
ibCorner.CornerRadius = UDim.new(0, 12)

local ibLabel = Instance.new("TextLabel", InputBoxTemplate)
ibLabel.Text = "Input:"
ibLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
ibLabel.BackgroundTransparency = 1
ibLabel.Size = UDim2.new(0.4, 0, 1, 0)
ibLabel.Position = UDim2.new(0, 15, 0, 0)
ibLabel.TextXAlignment = Enum.TextXAlignment.Left
ibLabel.Font = Enum.Font.Gotham
ibLabel.TextSize = 15

local ibBox = Instance.new("TextBox", InputBoxTemplate)
ibBox.AnchorPoint = Vector2.new(1, 0.5)
ibBox.Position = UDim2.new(1, -15, 0.5, 0)
ibBox.Size = UDim2.new(0.55, 0, 0, 34)
ibBox.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
ibBox.TextColor3 = Color3.new(1, 1, 1)
ibBox.PlaceholderText = "Enter text..."
ibBox.Font = Enum.Font.Gotham
ibBox.TextSize = 14

local ibBoxCorner = Instance.new("UICorner", ibBox)
ibBoxCorner.CornerRadius = UDim.new(0, 8)

-- Fade In Animation
local function FadeIn()
    Main.Position = UDim2.new(0.5, 0, -0.3, 0)
    Main.BackgroundTransparency = 1
    Shadow.ImageTransparency = 1
    Intro.BackgroundTransparency = 0

    TweenService:Create(Main, TweenInfo.new(0.7, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Position = UDim2.new(0.5, 0, 0.5, 0),
        BackgroundTransparency = 0.05
    }):Play()
    TweenService:Create(Shadow, TweenInfo.new(0.8), {ImageTransparency = 0.6}):Play()
    TweenService:Create(Logo, TweenInfo.new(0.8, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Size = UDim2.new(0.15, 0, 0.15, 0),
        Position = UDim2.new(0, 20, 0, 15)
    }):Play()

    task.wait(0.6)
    TweenService:Create(Intro, TweenInfo.new(0.6), {BackgroundTransparency = 1}):Play()
end

-- Close Animation
Close.MouseButton1Click:Connect(function()
    TweenService:Create(Intro, TweenInfo.new(0.4), {BackgroundTransparency = 0}):Play()
    task.wait(0.3)
    TweenService:Create(Main, TweenInfo.new(0.6, Enum.EasingStyle.Quint), {
        Position = UDim2.new(0.5, 0, -0.3, 0),
        BackgroundTransparency = 1
    }):Play()
    TweenService:Create(Shadow, TweenInfo.new(0.6), {ImageTransparency = 1}):Play()
end)

-- Open via Logo Click (if minimized)
Logo.MouseButton1Click:Connect(FadeIn)

-- Parent to gethui() or PlayerGui
local function GetParent()
    local hui = gethui and gethui() or game:GetService("CoreGui")
    return (pcall(function() Arceus.Parent = hui end) and hui) or game.Players.LocalPlayer:WaitForChild("PlayerGui")
end
Arceus.Parent = GetParent()

-- Public Functions
function lib:AddToggle(name, callback, default)
    local toggle = ToggleTemplate:Clone()
    toggle.Parent = Menu
    toggle:FindFirstChild("TextLabel").Text = name

    local indicator = toggle.Indicator
    local circle = indicator.Circle
    local enabled = default or false

    local function update()
        TweenService:Create(indicator, TweenInfo.new(0.3), {
            BackgroundColor3 = enabled and Color3.fromRGB(255, 80, 80) or Color3.fromRGB(60, 60, 80)
        }):Play()
        TweenService:Create(circle, TweenInfo.new(0.3), {
            Position = enabled and UDim2.new(1, -25, 0.5, 0) or UDim2.new(0, 3, 0.5, 0)
        }):Play()
    end

    toggle.MouseButton1Click:Connect(function()
        enabled = not enabled
        update()
        callback(enabled)
    end)

    if enabled then update() end
    return toggle
end

function lib:AddButton(name, callback)
    local btn = ButtonTemplate:Clone()
    btn.Parent = Menu
    btn.Text = name
    btn.MouseButton1Click:Connect(callback)
    return btn
end

function lib:AddInput(name, placeholder, callback)
    local input = InputBoxTemplate:Clone()
    input.Parent = Menu
    input:FindFirstChild("TextLabel").Text = name .. ":"
    local box = input.TextBox
    box.PlaceholderText = placeholder or "Enter text..."

    box.FocusLost:Connect(function(enter)
        if enter then callback(box.Text) end
    end)

    return { Frame = input, TextBox = box, SetText = function(t) box.Text = t end }
end

-- Init Fade In
FadeIn()

return lib
